
<!doctype html>
<html lang="es-AR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Admin Â· Voltri</title>
</head>
<body style="margin:0;font-family:system-ui;background:#0f0f0f;color:#f2f2f2">

<h1 style="padding:24px">Admin</h1>

<select id="mode">
  <option value="products">products.json</option>
  <option value="site">site.json</option>
</select>

<br><br>
<textarea id="editor" style="width:90%;height:400px"></textarea><br><br>
<input id="token" placeholder="ADMIN TOKEN">
<button onclick="save()">Guardar</button>

<script>
let MODE="products";
const editor=document.getElementById("editor");

function load(){
  fetch("/"+MODE+".json",{cache:"no-store"})
    .then(r=>r.text())
    .then(t=>editor.value=t);
}
document.getElementById("mode").onchange=e=>{
  MODE=e.target.value;
  load();
};
load();

function save(){
  fetch("/api/"+MODE,{
    method:"PUT",
    headers:{
      "content-type":"application/json",
      "authorization":"Bearer "+document.getElementById("token").value
    },
    body:editor.value
  }).then(r=>alert(r.ok?"Guardado":"Error"));
}
</script>

</body>
</html>
